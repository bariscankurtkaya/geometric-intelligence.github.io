
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>📚 Adding a Custom Dataset Tutorial &#8212; TopoBenchmark latest documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=c6e86fd7"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/tutorial_add_custom_dataset';</script>
    <link rel="canonical" href="https://geometric-intelligence.github.io/topobenchmark/notebooks/tutorial_add_custom_dataset.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using a new dataset" href="tutorial_dataset.html" />
    <link rel="prev" title="Homophily Tutorial" href="homophily_tutorial.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="latest" />
    <meta name="docbuild:last-update" content="Dec 24, 2024, 1:18:53 AM"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">TopoBenchmark latest documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing/index.html">
    Contributing
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../tutorials/index.html">
    Tutorials
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing/index.html">
    Contributing
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../tutorials/index.html">
    Tutorials
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="homophily_tutorial.html">Homophily Tutorial</a></li>



<li class="toctree-l1 current active"><a class="current reference internal" href="#">📚 Adding a Custom Dataset Tutorial</a></li>






<li class="toctree-l1"><a class="reference internal" href="tutorial_dataset.html">Using a new dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_lifting.html">Implementing your own lifting</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_model.html">Implementing your own model</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../tutorials/index.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">📚 Adding a Custom Dataset Tutorial</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="📚-Adding-a-Custom-Dataset-Tutorial">
<h1>📚 Adding a Custom Dataset Tutorial<a class="headerlink" href="#📚-Adding-a-Custom-Dataset-Tutorial" title="Link to this heading">#</a></h1>
<section id="🎯-Tutorial-Overview">
<h2>🎯 Tutorial Overview<a class="headerlink" href="#🎯-Tutorial-Overview" title="Link to this heading">#</a></h2>
<p>This comprehensive guide walks you through the process of integrating your custom dataset into our library. The process is divided into three main steps:</p>
<ol class="arabic simple">
<li><p><strong>Dataset Creation</strong> 🔨</p>
<ul class="simple">
<li><p>Implement data loading mechanisms</p></li>
<li><p>Define preprocessing steps</p></li>
<li><p>Structure data in the required format</p></li>
</ul>
</li>
<li><p><strong>Integrate with Dataset APIs</strong> 🔄</p>
<ul class="simple">
<li><p>Add dataset to the library framework</p></li>
<li><p>Ensure compatibility with existing systems</p></li>
<li><p>Set up proper inheritance structure</p></li>
</ul>
</li>
<li><p><strong>Configuration Setup</strong> ⚙️</p>
<ul class="simple">
<li><p>Define dataset parameters</p></li>
<li><p>Specify data paths and formats</p></li>
<li><p>Configure preprocessing options</p></li>
</ul>
</li>
</ol>
</section>
<section id="📋-Tutorial-Structure">
<h2>📋 Tutorial Structure<a class="headerlink" href="#📋-Tutorial-Structure" title="Link to this heading">#</a></h2>
<p>This tutorial follows a unique structure to provide the clearest possible learning experience:</p>
<blockquote>
<div><p>💡 <strong>Main Notebook (Current File)</strong> - High-level concepts and explanations - Step-by-step workflow description - References to implementation files</p>
</div></blockquote>
<blockquote>
<div><p>📁 <strong>Supporting Files</strong> - Detailed code implementations - Specific examples and use cases - Technical documentation</p>
</div></blockquote>
<section id="🛠️-Technical-Framework">
<h3>🛠️ Technical Framework<a class="headerlink" href="#🛠️-Technical-Framework" title="Link to this heading">#</a></h3>
<p>This tutorial demonstrates custom dataset integration using: - <code class="docutils literal notranslate"><span class="pre">torch_geometric.data.InMemoryDataset</span></code> as the base class - library’s dataset management system</p>
</section>
<section id="🎓-Important-Notes">
<h3>🎓 Important Notes<a class="headerlink" href="#🎓-Important-Notes" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>To make the learning process concrete, we’ll work with a practical toy “language” dataset example:</p></li>
<li><p>While we use the “language” dataset as an example, all file references use the generic <code class="docutils literal notranslate"><span class="pre">&lt;dataset_name&gt;</span></code> format for better generalization</p></li>
</ul>
</section>
</section>
</section>
<section id="Step-1:-Create-a-Dataset-🛠️">
<h1>Step 1: Create a Dataset 🛠️<a class="headerlink" href="#Step-1:-Create-a-Dataset-🛠️" title="Link to this heading">#</a></h1>
<section id="Overview">
<h2>Overview<a class="headerlink" href="#Overview" title="Link to this heading">#</a></h2>
<p>Adding your custom dataset to requires implementing specific loading and preprocessing functionality. We utilize the <code class="docutils literal notranslate"><span class="pre">torch_geometric.data.InMemoryDataset</span></code> interface to make this process straightforward.</p>
</section>
<section id="Required-Methods">
<h2>Required Methods<a class="headerlink" href="#Required-Methods" title="Link to this heading">#</a></h2>
<p>To implement your dataset, you need to override two key methods from the <code class="docutils literal notranslate"><span class="pre">torch_geometric.data.InMemoryDataset</span></code> class:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">download()</span></code>: Handles dataset acquisition</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">process()</span></code>: Manages data preprocessing</p></li>
</ul>
<blockquote>
<div><p>💡 <strong>Reference Implementation</strong>: For a complete example, check <code class="docutils literal notranslate"><span class="pre">topobenchmark/data/datasets/language_dataset.py</span></code></p>
</div></blockquote>
<section id="Deep-Dive:-The-Download-Method">
<h3>Deep Dive: The Download Method<a class="headerlink" href="#Deep-Dive:-The-Download-Method" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">download()</span></code> method is responsible for acquiring dataset files from external resources. Let’s examine its implementation using our language dataset example, where we store data in a GoogleDrive-hosted zip file.</p>
<section id="Implementation-Steps">
<h4>Implementation Steps<a class="headerlink" href="#Implementation-Steps" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p><strong>Download Data</strong> 📥</p></li>
</ol>
<ul class="simple">
<li><p>Fetch data from the specified source URL</p></li>
<li><p>Save to the raw directory</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><strong>Extract Content</strong> 📦</p></li>
</ol>
<ul class="simple">
<li><p>Unzip the downloaded file</p></li>
<li><p>Place contents in appropriate directory</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p><strong>Organize Files</strong> 📂</p></li>
</ol>
<ul class="simple">
<li><p>Move extracted files to named folders</p></li>
<li><p>Clean up temporary files and directories</p></li>
</ul>
</section>
<section id="Code-Implementation">
<h4>Code Implementation<a class="headerlink" href="#Code-Implementation" title="Link to this heading">#</a></h4>
<p>```python def download(self) -&gt; None: r”””Download the dataset from a URL and saves it to the raw directory.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Raises:
    FileNotFoundError: If the dataset URL is not found.
&quot;&quot;&quot;
# Step 1: Download data from the source
self.url = self.URLS[self.name]
self.file_format = self.FILE_FORMAT[self.name]
download_file_from_drive(
    file_link=self.url,
    path_to_save=self.raw_dir,
    dataset_name=self.name,
    file_format=self.file_format,
)

# Step 2: extract zip file
folder = self.raw_dir
filename = f&quot;{self.name}.{self.file_format}&quot;
path = osp.join(folder, filename)
extract_zip(path, folder)
# Delete zip file
os.unlink(path)

# Step 3: organize files
# Move files from osp.join(folder, name_download) to folder
for file in os.listdir(osp.join(folder, self.name)):
    shutil.move(osp.join(folder, self.name, file), folder)
# Delete osp.join(folder, self.name) dir
shutil.rmtree(osp.join(folder, self.name))
</pre></div>
</div>
</section>
</section>
</section>
</section>
<section id="Deep-Dive:-The-Process-Method">
<h1>Deep Dive: The Process Method<a class="headerlink" href="#Deep-Dive:-The-Process-Method" title="Link to this heading">#</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">process()</span></code> method handles data preprocessing and organization. Here’s the method’s structure:</p>
<p>```python def process(self) -&gt; None: r”””Handle the data for the dataset.</p>
<p>This method loads the Language dataset, applies preprocessing transformations, and saves processed data.”””</p>
<p># Step 1: extract the data … # Convert raw data to list of torch_geometric.data.Data objects</p>
<p># Step 2: collate the graphs self.data, self.slices = self.collate(graph_sentences)</p>
<p># Step 3: save processed data fs.torch_save( (self._data.to_dict(), self.slices, {}, self._data.__class__), self.processed_paths[0], )</p>
<p><code class="docutils literal notranslate"><span class="pre">self.collate</span></code> – Collates a list of Data or HeteroData objects to the internal storage format; meaning that it transforms a list of torch.data.Data objectis into one torch.data.BaseData.</p>
</section>
<section id="Step-2:-Integrate-with-Dataset-APIs-🔄">
<h1>Step 2: Integrate with Dataset APIs 🔄<a class="headerlink" href="#Step-2:-Integrate-with-Dataset-APIs-🔄" title="Link to this heading">#</a></h1>
<p>Now that we have created a dataset class, we need to integrate it with the library. In this section we describe where to add the dataset files and how to make it available through data loaders.</p>
<p>Here’s how to structure your files, the files highlighted with ** are going to be updated:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">topobenchmark/</span>
<span class="l l-Scalar l-Scalar-Plain">├── data/</span>
<span class="l l-Scalar l-Scalar-Plain">│   ├── datasets/</span>
<span class="l l-Scalar l-Scalar-Plain">│   │   ├── **init.py**</span>
<span class="l l-Scalar l-Scalar-Plain">│   │   ├── base.py</span>
<span class="l l-Scalar l-Scalar-Plain">│   │   ├── &lt;dataset_name&gt;.py</span><span class="w">   </span><span class="c1"># Your dataset file</span>
<span class="l l-Scalar l-Scalar-Plain">│   │   └── ...</span>
<span class="l l-Scalar l-Scalar-Plain">│   ├── loaders/</span>
<span class="l l-Scalar l-Scalar-Plain">│   │   ├── init.py</span>
<span class="l l-Scalar l-Scalar-Plain">│   │   ├── base.py</span>
<span class="l l-Scalar l-Scalar-Plain">│   │   ├── graph/</span>
<span class="l l-Scalar l-Scalar-Plain">│   │   │   ├── &lt;loader_name&gt;.py</span><span class="w">   </span><span class="c1"># Your loader file</span>
<span class="l l-Scalar l-Scalar-Plain">│   │   ├── hypergraph/</span>
<span class="l l-Scalar l-Scalar-Plain">│   │   │   ├── &lt;loader_name&gt;.py</span><span class="w">   </span><span class="c1"># Your loader file</span>
<span class="l l-Scalar l-Scalar-Plain">│   │   ├── .../</span>
</pre></div>
</div>
<p>To make your dataset available to library:</p>
<p>The file <code class="docutils literal notranslate"><span class="pre">&lt;dataset_name&gt;.py</span></code> has been created during the previous steps (<code class="docutils literal notranslate"><span class="pre">us_county_demos_dataset.py</span></code> in our case) and should be placed in the <code class="docutils literal notranslate"><span class="pre">topobenchmark/data/datasets/</span></code> directory.</p>
<p>The registry <code class="docutils literal notranslate"><span class="pre">topobenchmark/data/datasets/__init__.py</span></code> discovers the files in <code class="docutils literal notranslate"><span class="pre">topobenchmark/data/datasets</span></code> and updates <code class="docutils literal notranslate"><span class="pre">__all__</span></code> variable of <code class="docutils literal notranslate"><span class="pre">topobenchmark/data/datasets/__init__.py</span></code> automatically. Hence there is no need to update the <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file manually to allow your dataset to be loaded by the library. Simply creare a file <code class="docutils literal notranslate"><span class="pre">&lt;dataset_name&gt;.py</span></code> and place it in the <code class="docutils literal notranslate"><span class="pre">topobenchmark/data/datasets/</span></code> directory.</p>
<hr class="docutils" />
<p>Next it is required to update the data loader system. Modify the loader file (<code class="docutils literal notranslate"><span class="pre">topobenchmark/data/loaders/loaders.py</span></code>:) to include your custom dataset:</p>
<p>For the the example dataset we add the following into the file <code class="docutils literal notranslate"><span class="pre">topobenchmark/data/loaders/graph/us_county_demos_dataset_loader.py</span></code> which consist of the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">USCountyDemosDatasetLoader</span><span class="p">(</span><span class="n">AbstractLoader</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load US County Demos dataset with configurable year and task variable.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parameters : DictConfig</span>
<span class="sd">        Configuration parameters containing:</span>
<span class="sd">            - data_dir: Root directory for data</span>
<span class="sd">            - data_name: Name of the dataset</span>
<span class="sd">            - year: Year of the dataset (if applicable)</span>
<span class="sd">            - task_variable: Task variable for the dataset</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">USCountyDemosDataset</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load the US County Demos dataset.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        USCountyDemosDataset</span>
<span class="sd">            The loaded US County Demos dataset with the appropriate `data_dir`.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If dataset loading fails.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_dataset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redefine_data_dir</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dataset</span>

    <span class="k">def</span> <span class="nf">_initialize_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">USCountyDemosDataset</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the US County Demos dataset.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        USCountyDemosDataset</span>
<span class="sd">            The initialized dataset instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">USCountyDemosDataset</span><span class="p">(</span>
            <span class="n">root</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root_data_dir</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">data_name</span><span class="p">,</span>
            <span class="n">parameters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_redefine_data_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">USCountyDemosDataset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Redefine the data directory based on the chosen (year, task_variable) pair.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dataset : USCountyDemosDataset</span>
<span class="sd">            The dataset instance.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Path</span>
<span class="sd">            The redefined data directory path.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">dataset</span><span class="o">.</span><span class="n">processed_root</span>
</pre></div>
</div>
<p>where the method <code class="docutils literal notranslate"><span class="pre">load_dataset</span></code> is required while other methods are optional used for convenience and structure.</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">load_dataset</span></code> of <code class="docutils literal notranslate"><span class="pre">AbstractLoader</span></code> class requires to return <code class="docutils literal notranslate"><span class="pre">torch.utils.data.Dataset</span></code> object.</p></li>
<li><p><strong>Important:</strong> to allow the automatic registering of the loader, make sure to include “DatasetLoader” into name of loader class (Example: USCountyDemos<strong>DatasetLoader</strong>)</p></li>
</ul>
</section>
<section id="Step-3:-Define-Configuration-🔧">
<h1>Step 3: Define Configuration 🔧<a class="headerlink" href="#Step-3:-Define-Configuration-🔧" title="Link to this heading">#</a></h1>
<p>Now that we’ve integrated our dataset, we need to define its configuration parameters. In this section, we’ll explain how to create and structure the configuration file for your dataset.</p>
<section id="Configuration-File-Structure">
<h2>Configuration File Structure<a class="headerlink" href="#Configuration-File-Structure" title="Link to this heading">#</a></h2>
<p>Create a new YAML file for your dataset in <code class="docutils literal notranslate"><span class="pre">configs/dataset/&lt;dataset_name&gt;.yaml</span></code> with the following structure:</p>
<section id="While-creating-a-configuration-file,-you-will-need-to-specify:">
<h3>While creating a configuration file, you will need to specify:<a class="headerlink" href="#While-creating-a-configuration-file,-you-will-need-to-specify:" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Loader class (<code class="docutils literal notranslate"><span class="pre">topobenchmark.data.loaders.USCountyDemosDatasetLoader</span></code>) for automatic instantialization inside the provided pipeline and the parameters for the loader.</p></li>
</ol>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dataset loader config</span>
<span class="nt">loader</span><span class="p">:</span>
<span class="w">  </span><span class="nt">_target_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">topobenchmark.data.loaders.USCountyDemosDatasetLoader</span>
<span class="w">  </span><span class="nt">parameters</span><span class="p">:</span>
<span class="w">    </span><span class="nt">data_domain</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">graph</span><span class="w">             </span><span class="c1"># Primary data domain. Options: [&#39;graph&#39;, &#39;hypergrpah&#39;, &#39;cell, &#39;simplicial&#39;]</span>
<span class="w">    </span><span class="nt">data_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cornel</span><span class="w">              </span><span class="c1"># Data type. String emphasizing from where dataset come from.</span>
<span class="w">    </span><span class="nt">data_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">US-county-demos</span><span class="w">     </span><span class="c1"># Name of the dataset</span>
<span class="w">    </span><span class="nt">year</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2012</span><span class="w">                     </span><span class="c1"># In the case of US-county-demos there are multiple version of this dataset. Options:[2012, 2016]</span>
<span class="w">    </span><span class="nt">task_variable</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Election&#39;</span><span class="w">      </span><span class="c1"># Different target variable used as target. Options: [&#39;Election&#39;, &#39;MedianIncome&#39;, &#39;MigraRate&#39;, &#39;BirthRate&#39;, &#39;DeathRate&#39;, &#39;BachelorRate&#39;, &#39;UnemploymentRate&#39;]</span>
<span class="w">    </span><span class="nt">data_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${paths.data_dir}/${dataset.loader.parameters.data_domain}/${dataset.loader.parameters.data_type}</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>The dataset parameters:</p></li>
</ol>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dataset parameters</span>
<span class="nt">parameters</span><span class="p">:</span>
<span class="w">  </span><span class="nt">num_features</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6</span><span class="w">         </span><span class="c1"># Number of features in the dataset</span>
<span class="w">  </span><span class="nt">num_classes</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w">          </span><span class="c1"># Dimentuin of the target variable</span>
<span class="w">  </span><span class="nt">task</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regression</span><span class="w">        </span><span class="c1"># Dataset task. Options: [classification, regression]</span>
<span class="w">  </span><span class="nt">loss_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mse</span><span class="w">          </span><span class="c1"># Task-specific loss function</span>
<span class="w">  </span><span class="nt">monitor_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mae</span><span class="w">     </span><span class="c1"># Metric to monitor during training</span>
<span class="w">  </span><span class="nt">task_level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">node</span><span class="w">        </span><span class="c1"># Task level. Options: [classification, regression]</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>The dataset split parameters:</p></li>
</ol>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1">#splits</span>
<span class="nt">split_params</span><span class="p">:</span>
<span class="w">  </span><span class="nt">learning_setting</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">transductive</span><span class="w">      </span><span class="c1"># Type of learning. Options:[&#39;transductive&#39;, &#39;inductive&#39;]</span>
<span class="w">  </span><span class="nt">data_seed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span><span class="w">                        </span><span class="c1"># Seed for data splitting</span>
<span class="w">  </span><span class="nt">split_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">random</span><span class="w">                  </span><span class="c1"># Type of splitting. Options: [&#39;k-fold&#39;, &#39;random&#39;]</span>
<span class="w">  </span><span class="nt">k</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span><span class="w">                               </span><span class="c1"># Number of folds in case of &quot;k-fold&quot; cross-validation</span>
<span class="w">  </span><span class="nt">train_prop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.5</span><span class="w">                     </span><span class="c1"># Training proportion in case of &#39;random&#39; splitting strategy</span>
<span class="w">  </span><span class="nt">standardize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span><span class="w">                   </span><span class="c1"># Standardize the data or not. Options: [True, False]</span>
<span class="w">  </span><span class="nt">data_split_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${paths.data_dir}/data_splits/${dataset.loader.parameters.data_name}</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Finally the dataloader parameters:</p></li>
</ol>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dataloader parameters</span>
<span class="nt">dataloader_params</span><span class="p">:</span>
<span class="w">  </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w">       </span><span class="c1"># Number of graphs per batch. In sace of transductive always 1 as there is only one graph.</span>
<span class="w">  </span><span class="nt">num_workers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span><span class="w">      </span><span class="c1"># Number of workers for data loading</span>
<span class="w">  </span><span class="nt">pin_memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w">   </span><span class="c1"># Pin memory for data loading</span>
</pre></div>
</div>
</section>
<section id="Notes:">
<h3>Notes:<a class="headerlink" href="#Notes:" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">paths</span></code> section in the configuration file is automatically populated with the paths to the data directory and the data splits directory.</p></li>
<li><p>Some of the dataset parameters are used to configure the model.yaml and other files. Hence we suggest always include the above parameters in the dataset configuration file.</p></li>
</ul>
<p>Here’s the markdown for easy copying:</p>
</section>
</section>
<section id="Preparing-to-Load-the-Custom-Dataset:-Understanding-Configuration-Imports">
<h2>Preparing to Load the Custom Dataset: Understanding Configuration Imports<a class="headerlink" href="#Preparing-to-Load-the-Custom-Dataset:-Understanding-Configuration-Imports" title="Link to this heading">#</a></h2>
<p>Before loading our dataset, it’s crucial to understand the configuration imports, particularly those from the <code class="docutils literal notranslate"><span class="pre">topobenchmark.utils.config_resolvers</span></code> module. These utility functions play a key role in dynamically configuring your machine learning pipeline.</p>
<section id="Key-Imports-for-Dynamic-Configuration">
<h3>Key Imports for Dynamic Configuration<a class="headerlink" href="#Key-Imports-for-Dynamic-Configuration" title="Link to this heading">#</a></h3>
<p>Let’s import the essential configuration resolver functions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">topobenchmark.utils.config_resolvers</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">get_default_transform</span><span class="p">,</span>
    <span class="n">get_monitor_metric</span><span class="p">,</span>
    <span class="n">get_monitor_mode</span><span class="p">,</span>
    <span class="n">infer_in_channels</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="Why-These-Imports-Matter">
<h3>Why These Imports Matter<a class="headerlink" href="#Why-These-Imports-Matter" title="Link to this heading">#</a></h3>
<p>In our previous step, we explored configuration variables that use dynamic lookups, such as:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">data_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${paths.data_dir}/${dataset.loader.parameters.data_domain}/${dataset.loader.parameters.data_type}</span>
</pre></div>
</div>
<p>However, some configurations require more advanced automation, which is where these imported functions become invaluable.</p>
</section>
<section id="Practical-Example:-Dynamic-Transforms">
<h3>Practical Example: Dynamic Transforms<a class="headerlink" href="#Practical-Example:-Dynamic-Transforms" title="Link to this heading">#</a></h3>
<p>Consider the configuration in <code class="docutils literal notranslate"><span class="pre">projects/TopoBenchmark/configs/run.yaml</span></code>, where the <code class="docutils literal notranslate"><span class="pre">transforms</span></code> parameter uses the <code class="docutils literal notranslate"><span class="pre">get_default_transform</span></code> function:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">transforms</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${get_default_transform:${dataset},${model}}</span>
</pre></div>
</div>
<p>This syntax allows for automatic transformation selection based on the dataset and model, demonstrating the power of these configuration resolver functions.</p>
<p>By importing and utilizing these functions, you gain: - Flexible configuration management - Automatic parameter inference - Reduced manual configuration overhead</p>
<p>These facilitate seamless dataset loading and preprocessing for multiple topological domains and provide an easy and intuitive interface for incorporating novel functionality. ```</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hydra</span> <span class="kn">import</span> <span class="n">compose</span><span class="p">,</span> <span class="n">initialize</span>
<span class="kn">from</span> <span class="nn">hydra.utils</span> <span class="kn">import</span> <span class="n">instantiate</span>



<span class="kn">from</span> <span class="nn">topobenchmark.utils.config_resolvers</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">get_default_transform</span><span class="p">,</span>
    <span class="n">get_monitor_metric</span><span class="p">,</span>
    <span class="n">get_monitor_mode</span><span class="p">,</span>
    <span class="n">infer_in_channels</span><span class="p">,</span>
<span class="p">)</span>


<span class="n">initialize</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="s2">&quot;../configs&quot;</span><span class="p">,</span> <span class="n">job_name</span><span class="o">=</span><span class="s2">&quot;job&quot;</span><span class="p">)</span>
<span class="n">cfg</span> <span class="o">=</span> <span class="n">compose</span><span class="p">(</span>
    <span class="n">config_name</span><span class="o">=</span><span class="s2">&quot;run.yaml&quot;</span><span class="p">,</span>
    <span class="n">overrides</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;model=hypergraph/unignn2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dataset=graph/US-county-demos&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">return_hydra_config</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">instantiate</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">loader</span><span class="p">)</span>


<span class="n">dataset</span><span class="p">,</span> <span class="n">dataset_dir</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/tmp/ipykernel_1170891/1713955081.py:14: UserWarning:
The version_base parameter is not specified.
Please specify a compatability version level, or None.
Will assume defaults for version 1.1
  initialize(config_path=&#34;../configs&#34;, job_name=&#34;job&#34;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
US-county-demos(self.root=/home/lev/projects/TopoBenchmark/datasets/graph/cornel, self.name=US-county-demos, self.parameters={&#39;data_domain&#39;: &#39;graph&#39;, &#39;data_type&#39;: &#39;cornel&#39;, &#39;data_name&#39;: &#39;US-county-demos&#39;, &#39;year&#39;: 2012, &#39;task_variable&#39;: &#39;Election&#39;, &#39;data_dir&#39;: &#39;/home/lev/projects/TopoBenchmark/datasets/graph/cornel&#39;}, self.force_reload=False)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Data(x=[3224, 6], edge_index=[2, 18966], y=[3224])
</pre></div></div>
</div>
</section>
</section>
</section>
<section id="Step-4.1:-Default-Data-Transformations-⚙️">
<h1>Step 4.1: Default Data Transformations ⚙️<a class="headerlink" href="#Step-4.1:-Default-Data-Transformations-⚙️" title="Link to this heading">#</a></h1>
<p>While most datasets can be used directly after integration, some require specific preprocessing transformations. These transformations might vary depending on the task, model, or other conditions.</p>
<section id="Example-Case:-US-county-demos-Dataset">
<h2>Example Case: US-county-demos Dataset<a class="headerlink" href="#Example-Case:-US-county-demos-Dataset" title="Link to this heading">#</a></h2>
<p>Let’s look at our language dataset’s structure the <code class="docutils literal notranslate"><span class="pre">compose</span></code> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cfg</span> <span class="o">=</span> <span class="n">compose</span><span class="p">(</span>
    <span class="n">config_name</span><span class="o">=</span><span class="s2">&quot;run.yaml&quot;</span><span class="p">,</span>
    <span class="n">overrides</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;model=hypergraph/unignn2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dataset=graph/US-county-demos&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">return_hydra_config</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
<p>we can see that the model is <code class="docutils literal notranslate"><span class="pre">hypergraph/unignn2</span></code> from hypergraph domain while the dataset is from graph domain. This implied that the discussed above <code class="docutils literal notranslate"><span class="pre">get_default_transform</span></code> function:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">transforms</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${get_default_transform:${dataset},${model}}</span>
</pre></div>
</div>
<p>Inferred a default transform from graph to hypegraph domain.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Transform name:&#39;</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Transform parameters:&#39;</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">transforms</span><span class="p">[</span><span class="s1">&#39;graph2hypergraph_lifting&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Transform name: dict_keys([&#39;graph2hypergraph_lifting&#39;])
Transform parameters: {&#39;_target_&#39;: &#39;topobenchmark.transforms.data_transform.DataTransform&#39;, &#39;transform_type&#39;: &#39;lifting&#39;, &#39;transform_name&#39;: &#39;HypergraphKHopLifting&#39;, &#39;k_value&#39;: 1, &#39;feature_lifting&#39;: &#39;ProjectionSum&#39;, &#39;neighborhoods&#39;: &#39;${oc.select:model.backbone.neighborhoods,null}&#39;}
</pre></div></div>
</div>
<p>Some datasets require might require default transforms which are applied whenever it is nedded to model the data.</p>
<p>The topobenchmark library provides a simple way to define custom transformations and apply them to the dataset. Take a look at <code class="docutils literal notranslate"><span class="pre">TopoBenchmark/configs/transforms/dataset_defaults</span></code> folder where you can find some default transformations for different datasets.</p>
<p>For example, REDDIT-BINARY does not have initial node features and it is a common practice to define initial features as gaussian noise. Hence the <code class="docutils literal notranslate"><span class="pre">TopoBenchmark/configs/transforms/dataset_defaults/REDDIT-BINARY.yaml</span></code> file incorporates the <code class="docutils literal notranslate"><span class="pre">gaussian_noise</span></code> transform by default. Hence whenver you choose to uplodad the REDDIT-BINARY dataset (and do not modify <code class="docutils literal notranslate"><span class="pre">transforms</span></code> parameter), the <code class="docutils literal notranslate"><span class="pre">gaussian_noise</span></code> transform will be applied to the dataset.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">defaults</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">data_manipulations</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">equal_gaus_features</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">liftings@_here_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${get_required_lifting:graph,${model}}</span>
</pre></div>
</div>
<p>Below we provide an quick tutorial on how to create a data transformations and create a sequence of default transformations that will be executed whener you use the defined dataset config file.</p>
<p>Below we provide an quick tutorial on how to create a data transformations and create a sequence of default transformations that will be executed whener you use the defined dataset config file.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Avoid override transforms</span>
<span class="n">cfg</span> <span class="o">=</span> <span class="n">compose</span><span class="p">(</span>
    <span class="n">config_name</span><span class="o">=</span><span class="s2">&quot;run.yaml&quot;</span><span class="p">,</span>
    <span class="n">overrides</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;model=hypergraph/unignn2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dataset=graph/REDDIT-BINARY&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">return_hydra_config</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">instantiate</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">loader</span><span class="p">)</span>


<span class="n">dataset</span><span class="p">,</span> <span class="n">dataset_dir</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>REDDIT_BINARY dataset does not have any initial node features</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Data(edge_index=[2, 480], y=[1], num_nodes=218)
</pre></div></div>
</div>
<p>Take a look at the default transforms and the parameters of <code class="docutils literal notranslate"><span class="pre">equal_gaus_features</span></code> transform</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Transform name:&#39;</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Transform parameters:&#39;</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">transforms</span><span class="p">[</span><span class="s1">&#39;equal_gaus_features&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Transform name: dict_keys([&#39;equal_gaus_features&#39;, &#39;graph2hypergraph_lifting&#39;])
Transform parameters: {&#39;_target_&#39;: &#39;topobenchmark.transforms.data_transform.DataTransform&#39;, &#39;transform_name&#39;: &#39;EqualGausFeatures&#39;, &#39;transform_type&#39;: &#39;data manipulation&#39;, &#39;mean&#39;: 0, &#39;std&#39;: 0.1, &#39;num_features&#39;: &#39;${dataset.parameters.num_features}&#39;}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">topobenchmark.data.preprocessor</span> <span class="kn">import</span> <span class="n">PreProcessor</span>
<span class="n">preprocessed_dataset</span> <span class="o">=</span> <span class="n">PreProcessor</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="p">,</span> <span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;transforms&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Processing...
Done!
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preprocessed_dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Data(x=[218, 10], edge_index=[2, 480], y=[1], incidence_hyperedges=[218, 218], num_hyperedges=[1], x_0=[218, 10], x_hyperedges=[218, 10], num_nodes=218)
</pre></div></div>
</div>
<p>The preprocessed dataset has the features generated by the preprocessor. And the connectivity of the dataset has been transformed into hypegraph domain.</p>
<section id="Creating-your-own-default-transforms">
<h3>Creating your own default transforms<a class="headerlink" href="#Creating-your-own-default-transforms" title="Link to this heading">#</a></h3>
<p>Now when we have seen how to add custom dataset and how does the default transform works. One might want to reate your own default transforms for new dataset that will be executed always whenwever the dataset under default configuration is used.</p>
<p><strong>To configure</strong> the deafult transform navigate to <code class="docutils literal notranslate"><span class="pre">configs/transforms/dataset_defaults</span></code> create <code class="docutils literal notranslate"><span class="pre">&lt;def_transforms.yaml&gt;</span></code> and the follwoing <code class="docutils literal notranslate"><span class="pre">.yaml</span></code> file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">defaults</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">transform_1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">transform_1</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">transform_2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">transform_2</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">transform_3</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">transform_3</span>
</pre></div>
</div>
<p><strong>Important</strong> There are different types of transforms, including <code class="docutils literal notranslate"><span class="pre">data_manipulation</span></code>, <code class="docutils literal notranslate"><span class="pre">liftings</span></code>, and <code class="docutils literal notranslate"><span class="pre">feature_liftings</span></code>. In case you want to use multiple transforms from the same categoty, let’s say from <code class="docutils literal notranslate"><span class="pre">data_manipulation</span></code>, then it is required to stick to a special syntaxis. <a href="#id2"><span class="problematic" id="id3">`See hydra configuration for more information &lt;&gt;`__</span></a> or the example below:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">defaults</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">data_manipulation@first_usage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">transform_1</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">data_manipulation@second_usage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">transform_2</span>
</pre></div>
</div>
</section>
<section id="id1">
<h3>Notes:<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Transforms from the same category:</strong> If There are a two transforms from the same catgory, for example, <code class="docutils literal notranslate"><span class="pre">data_manipulations</span></code>, it is required to use operator <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> to assign new diffrerent names <code class="docutils literal notranslate"><span class="pre">first_usage</span></code> and <code class="docutils literal notranslate"><span class="pre">second_usage</span></code> to each transform.</p></li>
<li><p>In the case of <code class="docutils literal notranslate"><span class="pre">equal_gaus_features</span></code> we have to override the initial number of features as the <code class="docutils literal notranslate"><span class="pre">equal_gaus_features.yaml</span></code> which uses a special register to infer the feature dimension (the registed logic descrived in Step 3.) However by some reason we want to specify <code class="docutils literal notranslate"><span class="pre">num_features</span></code> parameter we can override it in the default file without the need to change the transform config file.</p></li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">defaults</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">data_manipulations@equal_gaus_features</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">equal_gaus_features</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">data_manipulations@some_transform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">some_transform</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">liftings@_here_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${get_required_lifting:graph,${model}}</span>

<span class="nt">equal_gaus_features</span><span class="p">:</span>
<span class="w">  </span><span class="nt">num_features</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="nt">some_transform</span><span class="p">:</span>
<span class="w">  </span><span class="nt">some_param</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bla</span>
</pre></div>
</div>
<ul class="simple">
<li><p>We recommend to always add <code class="docutils literal notranslate"><span class="pre">liftings&#64;_here_:</span> <span class="pre">${get_required_lifting:graph,${model}}</span></code> so that a default lifting is applied to run any domain-specific topological model.</p></li>
</ul>
</section>
</section>
</section>
<section id="Step-4.2:-Custom-Data-Transformations-⚙️">
<h1>Step 4.2: Custom Data Transformations ⚙️<a class="headerlink" href="#Step-4.2:-Custom-Data-Transformations-⚙️" title="Link to this heading">#</a></h1>
<p>In general any transfom in the library inherits <code class="docutils literal notranslate"><span class="pre">torch_geometric.transforms.BaseTransform</span></code> class, which allow to apply a sequency of transforms to the data. Our inderface requires to implement the <code class="docutils literal notranslate"><span class="pre">forward</span></code> method. The important part of all transforms is that it takes <code class="docutils literal notranslate"><span class="pre">torch_geometric.data.Data</span></code> object and returns updated <code class="docutils literal notranslate"><span class="pre">torch_geometric.data.Data</span></code> object.</p>
<p>For language dataset, we have generated the <code class="docutils literal notranslate"><span class="pre">equal_gaus_features</span></code> transfroms that is a data_manipulation transform hence we place it into <code class="docutils literal notranslate"><span class="pre">topobenchmark/transforms/data_manipulation/</span></code> folder. Below you can see th <code class="docutils literal notranslate"><span class="pre">EqualGausFeatures</span></code> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">EqualGausFeatures</span><span class="p">(</span><span class="n">torch_geometric</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">BaseTransform</span><span class="p">):</span>
<span class="w"> </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;A transform that generates equal Gaussian features for all nodes.</span>

<span class="sd"> Parameters</span>
<span class="sd"> ----------</span>
<span class="sd"> **kwargs : optional</span>
<span class="sd">     Additional arguments for the class. It should contain the following keys:</span>
<span class="sd">     - mean (float): The mean of the Gaussian distribution.</span>
<span class="sd">     - std (float): The standard deviation of the Gaussian distribution.</span>
<span class="sd">     - num_features (int): The number of features to generate.</span>
<span class="sd"> &quot;&quot;&quot;</span>

 <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
     <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s2">&quot;generate_non_informative_features&quot;</span>

     <span class="c1"># Torch generate feature vector from gaus distribution</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">std</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;std&quot;</span><span class="p">]</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">feature_vector</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;num_features&quot;</span><span class="p">]</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">feature_vector</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span>
         <span class="n">mean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">std</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_vector</span><span class="p">)</span>
     <span class="p">)</span>

 <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
     <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(type=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="si">!r}</span><span class="s2">, mean=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="si">!r}</span><span class="s2">, std=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">std</span><span class="si">!r}</span><span class="s2">, feature_vector=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_vector</span><span class="si">!r}</span><span class="s2">)&quot;</span>

 <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">torch_geometric</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Data</span><span class="p">):</span>
<span class="w">     </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Apply the transform to the input data.</span>

<span class="sd">     Parameters</span>
<span class="sd">     ----------</span>
<span class="sd">     data : torch_geometric.data.Data</span>
<span class="sd">         The input data.</span>

<span class="sd">     Returns</span>
<span class="sd">     -------</span>
<span class="sd">     torch_geometric.data.Data</span>
<span class="sd">         The transformed data.</span>
<span class="sd">     &quot;&quot;&quot;</span>
     <span class="n">data</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_vector</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">num_nodes</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
     <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>As we said above the <code class="docutils literal notranslate"><span class="pre">forward</span></code> function takes as input the <code class="docutils literal notranslate"><span class="pre">torch_geometric.data.Data</span></code> object, modifies it, and returns it.</p>
<p>Similarly to adding dataset the transformations you have created and placed at right folder are automatically registered.</p>
<p>Now as we have registered the transform we can finally create the configuration file and use it in the framework:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">_target_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">topobenchmark.transforms.data_transform.DataTransform</span>
<span class="nt">transform_name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;EqualGausFeatures&quot;</span>
<span class="nt">transform_type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;data</span><span class="nv"> </span><span class="s">manipulation&quot;</span>

<span class="nt">mean</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">std</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.1</span>
<span class="nt">num_features</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${dataset.parameters.num_features}</span>
</pre></div>
</div>
<p>Please refer to <code class="docutils literal notranslate"><span class="pre">configs/transforms/dataset_defaults/equal_gaus_features.yaml</span></code> for the example.</p>
<p><strong>Notes:</strong></p>
<ul class="simple">
<li><p>You might notice an interesting key <code class="docutils literal notranslate"><span class="pre">_target_</span></code> in the configuration file. In general for any new transform you the <code class="docutils literal notranslate"><span class="pre">_target_</span></code> is always <code class="docutils literal notranslate"><span class="pre">topobenchmark.transforms.data_transform.DataTransform</span></code>. <a class="reference external" href="https://hydra.cc/docs/advanced/instantiate_objects/overview/">For more information please refer to hydra documentation “Instantiating objects with Hydra” section.</a>.</p></li>
</ul>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="homophily_tutorial.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Homophily Tutorial</p>
      </div>
    </a>
    <a class="right-next"
       href="tutorial_dataset.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Using a new dataset</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">📚 Adding a Custom Dataset Tutorial</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#🎯-Tutorial-Overview">🎯 Tutorial Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#📋-Tutorial-Structure">📋 Tutorial Structure</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#🛠️-Technical-Framework">🛠️ Technical Framework</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#🎓-Important-Notes">🎓 Important Notes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#Step-1:-Create-a-Dataset-🛠️">Step 1: Create a Dataset 🛠️</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Required-Methods">Required Methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Deep-Dive:-The-Download-Method">Deep Dive: The Download Method</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Implementation-Steps">Implementation Steps</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Code-Implementation">Code Implementation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#Deep-Dive:-The-Process-Method">Deep Dive: The Process Method</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#Step-2:-Integrate-with-Dataset-APIs-🔄">Step 2: Integrate with Dataset APIs 🔄</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#Step-3:-Define-Configuration-🔧">Step 3: Define Configuration 🔧</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Configuration-File-Structure">Configuration File Structure</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#While-creating-a-configuration-file,-you-will-need-to-specify:">While creating a configuration file, you will need to specify:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Notes:">Notes:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Preparing-to-Load-the-Custom-Dataset:-Understanding-Configuration-Imports">Preparing to Load the Custom Dataset: Understanding Configuration Imports</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Key-Imports-for-Dynamic-Configuration">Key Imports for Dynamic Configuration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Why-These-Imports-Matter">Why These Imports Matter</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Practical-Example:-Dynamic-Transforms">Practical Example: Dynamic Transforms</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#Step-4.1:-Default-Data-Transformations-⚙️">Step 4.1: Default Data Transformations ⚙️</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Example-Case:-US-county-demos-Dataset">Example Case: US-county-demos Dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Creating-your-own-default-transforms">Creating your own default transforms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Notes:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#Step-4.2:-Custom-Data-Transformations-⚙️">Step 4.2: Custom Data Transformations ⚙️</a></li>
</ul>

  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/notebooks/tutorial_add_custom_dataset.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2022-2023, PyT-Team, Inc..
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>